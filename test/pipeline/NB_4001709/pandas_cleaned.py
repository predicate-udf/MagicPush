import pandas as pd
import pickle
df0=pickle.load(open('data_0.pickle','rb'))
df4 = df0[df0["COUNTRY_OF_CITIZENSHIP"] == "SOUTH KOREA"]
df10 = df4[df4["WAGE_OFFER_UNIT_OF_PAY_9089"] == "Year"]
df13 = df10[["CASE_STATUS","DECISION_ELAPSED_DAYS","EMPLOYER_POSTAL_CODE","EMPLOYER_STATE","EMPLOYER_NUM_EMPLOYEES","WAGE_OFFER_FROM_9089","COUNTRY_OF_CITIZENSHIP","CLASS_OF_ADMISSION","FOREIGN_WORKER_INFO_EDUCATION","CASE_RECEIVED_DATE_MONTH"]]
df13["EMPLOYER_STATES"] = df13.apply(lambda xxx__: {'AL': 'ALABAMA', 'AK': 'ALASKA', 'AZ': 'ARIZONA', 'AR': 'ARKANSAS', 'CA': 'CALIFORNIA', 'CO': 'COLORADO', 'CT': 'CONNECTICUT', 'DE': 'DELAWARE', 'FL': 'FLORIDA', 'GA': 'GEORGIA', 'HI': 'HAWAII', 'ID': 'IDAHO', 'IL': 'ILLINOIS', 'IN': 'INDIANA', 'IA': 'IOWA', 'KS': 'KANSAS', 'KY': 'KENTUCKY', 'LA': 'LOUISIANA', 'ME': 'MAINE', 'MD': 'MARYLAND', 'MA': 'MASSACHUSETTS', 'MI': 'MICHIGAN', 'MN': 'MINNESOTA', 'MS': 'MISSISSIPPI', 'MO': 'MISSOURI', 'MT': 'MONTANA', 'NE': 'NEBRASKA', 'NV': 'NEVADA', 'NH': 'NEW HAMPSHIRE', 'NJ': 'NEW JERSEY', 'NM': 'NEW MEXICO', 'NY': 'NEW YORK', 'NC': 'NORTH CAROLINA', 'ND': 'NORTH DAKOTA', 'OH': 'OHIO', 'OK': 'OKLAHOMA', 'OR': 'OREGON', 'PA': 'PENNSYLVANIA', 'RI': 'RHODE ISLAND', 'SC': 'SOUTH CAROLINA', 'SD': 'SOUTH DAKOTA', 'TN': 'TENNESSEE', 'TX': 'TEXAS', 'UT': 'UTAH', 'VT': 'VERMONT', 'VA': 'VIRGINIA', 'WA': 'WASHINGTON', 'WV': 'WEST VIRGINIA', 'WI': 'WISCONSIN', 'WY': 'WYOMING'}[xxx__['EMPLOYER_STATE']] \
    if xxx__['EMPLOYER_STATE'] in ['AL', 'AK', 'AZ', 'AR', 'CA', 'CO', 'CT', 'DE', 'FL', 'GA', 'HI', 'ID', 'IL', 'IN', 'IA', 'KS', 'KY', 'LA', 'ME', 'MD', 'MA', 'MI', 'MN', 'MS', 'MO', 'MT', 'NE', 'NV', 'NH', 'NJ', 'NM', 'NY', 'NC', 'ND', 'OH', 'OK', 'OR', 'PA', 'RI', 'SC', 'SD', 'TN', 'TX', 'UT', 'VT', 'VA', 'WA', 'WV', 'WI', 'WY'] else xxx__['EMPLOYER_STATE'], axis=1)
df18 = df13.dropna(subset=["CASE_STATUS","DECISION_ELAPSED_DAYS","EMPLOYER_POSTAL_CODE","EMPLOYER_STATE","EMPLOYER_NUM_EMPLOYEES","WAGE_OFFER_FROM_9089","COUNTRY_OF_CITIZENSHIP","CLASS_OF_ADMISSION","FOREIGN_WORKER_INFO_EDUCATION","CASE_RECEIVED_DATE_MONTH","EMPLOYER_STATES"])
df53 = df18.drop(columns=["CASE_STATUS"])
