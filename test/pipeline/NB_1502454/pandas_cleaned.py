import pandas as pd
import pickle
df187=pickle.load(open('data_187.pickle','rb'))
df189 = df187.rename(columns={ "@OBS_VALUE":"US.LE_IX","@TIME_PERIOD":"date" })
df293 = df187.rename(columns={ "@OBS_VALUE":"US.PCPI_IX","@TIME_PERIOD":"date" })
df294 = df189.merge(df293, left_on=["date"],right_on=["date"])
df403=pickle.load(open('data_403.pickle','rb'))
df405 = df403.rename(columns={ "@OBS_VALUE":"US.ENDE_XDC_USD_RATE","@TIME_PERIOD":"date" })
df189 = df294.merge(df405, left_on=["date"],right_on=["date"])
df514=pickle.load(open('data_514.pickle','rb'))
df516 = df514.rename(columns={ "@OBS_VALUE":"KR.LE_IX","@TIME_PERIOD":"date" })
df517 = df189.merge(df516, left_on=["date"],right_on=["date"])
df626=pickle.load(open('data_626.pickle','rb'))
df628 = df626.rename(columns={ "@OBS_VALUE":"KR.PCPI_IX","@TIME_PERIOD":"date" })
df629 = df517.merge(df628, left_on=["date"],right_on=["date"])
df405=pickle.load(open('data_405.pickle','rb'))
df739 = df405.rename(columns={ "@OBS_VALUE":"KR.ENDE_XDC_USD_RATE","@TIME_PERIOD":"date" })
df740 = df629.merge(df739, left_on=["date"],right_on=["date"])
df849=pickle.load(open('data_849.pickle','rb'))
df851 = df849.rename(columns={ "@OBS_VALUE":"JP.LE_IX","@TIME_PERIOD":"date" })
df852 = df740.merge(df851, left_on=["date"],right_on=["date"])
df962 = df514.rename(columns={ "@OBS_VALUE":"JP.PCPI_IX","@TIME_PERIOD":"date" })
df963 = df852.merge(df962, left_on=["date"],right_on=["date"])
df1072=pickle.load(open('data_1072.pickle','rb'))
df1074 = df1072.rename(columns={ "@OBS_VALUE":"JP.ENDE_XDC_USD_RATE","@TIME_PERIOD":"date" })
df1075 = df963.merge(df1074, left_on=["date"],right_on=["date"])
df1184=pickle.load(open('data_1184.pickle','rb'))
df1186 = df1184.rename(columns={ "@OBS_VALUE":"RU.LE_IX","@TIME_PERIOD":"date" })
df1187 = df1075.merge(df1186, left_on=["date"],right_on=["date"])
df1297 = df1072.rename(columns={ "@OBS_VALUE":"RU.PCPI_IX","@TIME_PERIOD":"date" })
df1298 = df1187.merge(df1297, left_on=["date"],right_on=["date"])
df1407=pickle.load(open('data_1407.pickle','rb'))
df1409 = df1407.rename(columns={ "@OBS_VALUE":"RU.ENDE_XDC_USD_RATE","@TIME_PERIOD":"date" })
df1410 = df1298.merge(df1409, left_on=["date"],right_on=["date"])
df1413 = df1410[["date","US.LE_IX","US.PCPI_IX","US.ENDE_XDC_USD_RATE","KR.LE_IX","KR.PCPI_IX","KR.ENDE_XDC_USD_RATE","JP.LE_IX","JP.PCPI_IX","JP.ENDE_XDC_USD_RATE","RU.LE_IX","RU.PCPI_IX","RU.ENDE_XDC_USD_RATE"]]
df1416=pickle.load(open('data_1416.pickle','rb'))
df1419 = df1416[~df1416["marketcap(USD)"].isnull()]
df1421 = df1419.dropna(subset=["date","marketcap(USD)"])
df1425 = df1421.merge(df1413, how='left', left_on=["date"],right_on=["date"])
df1425["date"] = pd.to_datetime(df1425["date"])
df1457 = df1425[df1425["date"] < pd.to_datetime("2016-06-01 00:00:00")]

#df1457 = df1431.dropna(subset=["date","marketcap(USD)","US.LE_IX","US.PCPI_IX","US.ENDE_XDC_USD_RATE","KR.LE_IX","KR.PCPI_IX","KR.ENDE_XDC_USD_RATE","JP.LE_IX","JP.PCPI_IX","JP.ENDE_XDC_USD_RATE","RU.LE_IX","RU.PCPI_IX","RU.ENDE_XDC_USD_RATE"])
df1479 = df1457[(df1457["date"] >= pd.to_datetime("2016-01-01 00:00:00")) & (df1457["date"] < pd.to_datetime("2016-06-01 00:00:00"))]
